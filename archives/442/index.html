
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>PyGObject 学习笔记(10)-GMenu &#038; GSimpleAction - 一个人的世界</title>
    <meta name="author" content="DawnDIY">
    
	<meta name="description" content="一个人的世界 - 技术博客">
    <meta name="keywords" content="PyGObject, PyGtk, GMenu, GSimpleAction, 学习笔记">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="一个人的世界" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <script src="/javascripts/ajaxify.js"></script>
   
    
</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        DawnDIY
    </div>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  <!-- GitHub -->
  <li>
  <a href="https://github.com/DawnDIY" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a href="http://www.twitter.com/DawnDIYSoft" class="twitter" title="Twitter"></a>
  </li>
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/blog/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form method="get" action="/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload --> 
    <div id="content" class="inner">
        <article class="post">
	<h2 class="title">PyGObject 学习笔记(10)-GMenu &#038; GSimpleAction</h2>
	<div class="entry-content"><h1></h1>

<p>有段时间没更新了，一直想着想重新改一下Bolg，所以没怎么写了。好~二话不说，现在继续。今天来讲一个新的控件，一看标题，对！又是菜单，但这次菜单和之前的<a href="http://www.dawndiy.com/archives/290" title="PyGtk学习笔记(6)–菜单">《PyGtk学习笔记(6)–菜单》</a>的菜单是不同，自从转向学习PyGObject了，会有很多GTK 3的特性，所以，这次的 GMenu 和以往的菜单不同。所以老规矩，看图吧。</p>

<p><img src="http://i.imgur.com/sNe0XA5.jpg" title="GMenu" alt="" /></p>

<p>上面的图就是 GMenu 在原生 Gnome3 桌面里面显示的效果。好了，开始介绍。</p>

<h2>一. 介绍</h2>

<p>Ubuntu 的 Unity 桌面使用了全局菜单，为应用程序增加了很多可视空间。当然，在 Gnome3 里面同样可以省去传统的 MenuBar ，根据 Gnome3 的新特性，增加了 GMenu 。就像上面的图一样，将菜单功能集成在 Gnome 的任务栏中，同样为用户挤出了更多的空间，而且现在很多 Gnome3 的应用也开始使用这一特性了，如：Empathy。当然，刚开始很多童鞋找不到菜单在最顶上，呵呵，不过发现了以后还是会比较惊喜，这样会省出一个 Bar 的空间。</p>

<h3>1.类结构</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>GObject
</span><span class='line'>    ----GMenuModel
</span><span class='line'>          ----GMenu</span></code></pre></td></tr></table></div></figure>


<p>要注意的是，GMenu 是在 GIO 中，而不是在 GTK 中，所以应该导入 Gio 模块</p>

<!-- more -->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Gio</span>
</span></code></pre></td></tr></table></div></figure>


<h3> 2.常用方法</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">insert</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">detailed_action</span><span class="p">)</span>
</span><span class='line'><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">detailed_action</span><span class="p">)</span>   <span class="c"># 加到最后</span>
</span><span class='line'><span class="n">prepend</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">detailed_action</span><span class="p">)</span>  <span class="c"># 加到最前</span>
</span></code></pre></td></tr></table></div></figure>


<p>在菜单中插入一个选项<br/>
<em>position: 位置</em><br/>
<em>label: 显示标签</em><br/>
<em>detailed_action: 动作名，以 app. 为前缀</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">insert_section</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
</span><span class='line'><span class="n">append_section</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
</span><span class='line'><span class="n">prepend_section</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>在菜单中插入一个区域，上下会有分割线隔开<br/>
<em>position: 位置</em><br/>
<em>label: 区域名</em><br/>
<em>section: 可以是一个 GMenu</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">insert_submenu</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
</span><span class='line'><span class="n">append_submenu</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
</span><span class='line'><span class="n">prepend_submenu</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>在菜单中插入一个子菜单<br/>
<em>position: 位置</em><br/>
<em>label: 区域名</em><br/>
<em>section: 可以是一个 GMenu</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">remove</span><span class="p">(</span><span class="n">postion</span><span class="p">)</span>    <span class="c"># 删除选项</span>
</span><span class='line'><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>   <span class="c"># 设置显示标签</span>
</span></code></pre></td></tr></table></div></figure>


<h3> 2.代码分析</h3>

<p>以下是是想最上面图中的菜单的效果：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/env python</span>
</span><span class='line'><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class='line'>
</span><span class='line'><span class="c"># GMenu &amp; SimpleActions</span>
</span><span class='line'><span class="c"># PyGObject Study Notes By DawnDIY</span>
</span><span class='line'><span class="c"># http://dawndiy.com</span>
</span><span class='line'>
</span><span class='line'><span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Gtk</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Gio</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MyWindow</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ApplicationWindow</span><span class="p">):</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
</span><span class='line'>        <span class="n">Gtk</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;GMenu Example&quot;</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="n">app</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MyApplication</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Application</span><span class="p">):</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>        <span class="n">Gtk</span><span class="o">.</span><span class="n">Application</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">do_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>        <span class="n">win</span> <span class="o">=</span> <span class="n">MyWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span class='line'>        <span class="n">win</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">do_startup</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>        <span class="c"># 启动应用</span>
</span><span class='line'>        <span class="n">Gtk</span><span class="o">.</span><span class="n">Application</span><span class="o">.</span><span class="n">do_startup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># 建立顶层菜单</span>
</span><span class='line'>        <span class="n">menu</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
</span><span class='line'>        <span class="c"># 新建三个菜单选项</span>
</span><span class='line'>        <span class="n">item_new</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">MenuItem</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;New&quot;</span><span class="p">,</span> <span class="s">&quot;app.new&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">item_about</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">MenuItem</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;About&quot;</span><span class="p">,</span> <span class="s">&quot;app.about&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">item_quit</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">MenuItem</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;Quit&quot;</span><span class="p">,</span> <span class="s">&quot;app.quit&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># 建立菜单，作为子菜单</span>
</span><span class='line'>        <span class="n">submenu</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
</span><span class='line'>        <span class="c"># 直接添加2个选项</span>
</span><span class='line'>        <span class="n">submenu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;sub_New&quot;</span><span class="p">,</span> <span class="s">&quot;app.new&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">submenu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;sub_About&quot;</span><span class="p">,</span> <span class="s">&quot;app.about&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># 建立菜单，作为父菜单</span>
</span><span class='line'>        <span class="n">menu2</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
</span><span class='line'>        <span class="c"># 将子菜单添加进来</span>
</span><span class='line'>        <span class="n">menu2</span><span class="o">.</span><span class="n">append_submenu</span><span class="p">(</span><span class="s">&quot;Sub&quot;</span><span class="p">,</span> <span class="n">submenu</span><span class="p">)</span>
</span><span class='line'>        <span class="n">menu2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;exit&quot;</span><span class="p">,</span> <span class="s">&quot;app.quit&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># 把选项、父菜单都加入到顶层菜单中</span>
</span><span class='line'>        <span class="n">menu</span><span class="o">.</span><span class="n">append_item</span><span class="p">(</span><span class="n">item_new</span><span class="p">)</span>
</span><span class='line'>        <span class="n">menu</span><span class="o">.</span><span class="n">append_item</span><span class="p">(</span><span class="n">item_about</span><span class="p">)</span>
</span><span class='line'>        <span class="n">menu</span><span class="o">.</span><span class="n">append_section</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">menu2</span><span class="p">)</span>  <span class="c"># 父菜单添加为不同菜单区域</span>
</span><span class='line'>        <span class="n">menu</span><span class="o">.</span><span class="n">append_item</span><span class="p">(</span><span class="n">item_quit</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># 将顶层菜单作为应用程序的菜单</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">set_app_menu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># 为菜单 new 选项添加动作</span>
</span><span class='line'>        <span class="n">new_action</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SimpleAction</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;new&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</span><span class='line'>        <span class="c"># 连接到回调函数 new_cb</span>
</span><span class='line'>        <span class="n">new_action</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;activate&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_cb</span><span class="p">)</span>
</span><span class='line'>        <span class="c"># 将动作添加到应用中 </span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span><span class="n">new_action</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># about 选项</span>
</span><span class='line'>        <span class="n">about_action</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SimpleAction</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;about&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</span><span class='line'>        <span class="n">about_action</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;activate&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">about_cb</span><span class="p">)</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span><span class="n">about_action</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># quit 选项 </span>
</span><span class='line'>        <span class="n">quit_action</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SimpleAction</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;quit&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</span><span class='line'>        <span class="n">quit_action</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;activate&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quit_cb</span><span class="p">)</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span><span class="n">quit_action</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># new 的回调函数 </span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">new_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
</span><span class='line'>        <span class="k">print</span><span class="p">(</span><span class="s">&quot;This does nothing. It is only a demonstration.&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># about 的回调函数 </span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">about_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
</span><span class='line'>        <span class="k">print</span><span class="p">(</span><span class="s">&quot;No AboutDialog for you. This is only a demonstration.&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># about 的回调函数 </span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">quit_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
</span><span class='line'>        <span class="k">print</span><span class="p">(</span><span class="s">&quot;You have quit.&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="n">app</span> <span class="o">=</span> <span class="n">MyApplication</span><span class="p">()</span>
</span><span class='line'><span class="n">exit_status</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</span><span class='line'><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">exit_status</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>代码中我已经注释的很详细了，相信认真看都能看懂的！下面我就补充一下前面提到的 GSimpleAction 。</p>

<p>GSimpleAction 继承自 GObject， 用于建立一个独立的动作，使用它可以连接你的回调函数。</p>

<p>常用函数有：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">action</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SimpleAction</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">parameter_type</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>新建一个动作</em><br/>
<em>name: 动作名</em><br/>
<em>parameter_type: 参数类型，可以为 None</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">set_enabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>设置是否启用</em></p>

<h3>3.总结</h3>

<p>好吧，又写了一篇。希望感兴趣的朋友们能一起来交流！我刚看到 GMenu 的时候是用 Empathy 的时候发现它的菜单变化了，不过第一次用确实没找到菜单，呵呵，最后才知道这样的设计其实挺好的，节省了可视空间，尤其是在你的应用有很复杂的UI的时候，最后还是谈到用户体验了。</p>

<p>PS：这次我学 GMenu 的时候其实我也找了很多资料，不过 PyGObject 的资料不多，最后还是拿着 C 的 GTK 开发手册（就是那个devhelp）一个个函数看的。所以，还是要多看看 API 文档。</p>

<p>待续。。。</p>

<p> </p>
</div>

<div class="meta">
	
		<span class="comments"><a href="/archives/442#disqus_thread">Comments</a></span>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2013

    DawnDIY
. Powered by <a href="http://octopress.org">Octopress</a> | 
    Theme <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>
<!-- Baidu Code -->
<script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F75b11f0cdf8a42f433eccd74de441dae' type='text/javascript'%3E%3C/script%3E"));
</script>



    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'DawnDIY';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
